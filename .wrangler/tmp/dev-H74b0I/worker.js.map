{
  "version": 3,
  "sources": ["../bundle-8HlAwq/strip-cf-connecting-ip-header.js", "../../../src/worker.js", "../../../node_modules/wrangler/templates/middleware/middleware-ensure-req-body-drained.ts", "../../../node_modules/wrangler/templates/middleware/middleware-miniflare3-json-error.ts", "../bundle-8HlAwq/middleware-insertion-facade.js", "../../../node_modules/wrangler/templates/middleware/common.ts", "../bundle-8HlAwq/middleware-loader.entry.ts"],
  "sourceRoot": "/Users/tuanhung/Desktop/project/.wrangler/tmp/dev-H74b0I",
  "sourcesContent": ["function stripCfConnectingIPHeader(input, init) {\n\tconst request = new Request(input, init);\n\trequest.headers.delete(\"CF-Connecting-IP\");\n\treturn request;\n}\n\nglobalThis.fetch = new Proxy(globalThis.fetch, {\n\tapply(target, thisArg, argArray) {\n\t\treturn Reflect.apply(target, thisArg, [\n\t\t\tstripCfConnectingIPHeader.apply(null, argArray),\n\t\t]);\n\t},\n});\n", "export default {\n  async fetch(request, env, ctx) {\n    const url = new URL(request.url);\n    const { pathname } = url;\n\n    // CORS preflight\n    if (request.method === \"OPTIONS\") {\n      return new Response(null, { status: 204, headers: corsHeaders() });\n    }\n\n    try {\n      if (pathname.startsWith(\"/api/attributes\")) {\n        return await handleAttributes(request, env, url);\n      }\n      if (pathname.startsWith(\"/api/products\")) {\n        return await handleProducts(request, env, url);\n      }\n      if (pathname.startsWith(\"/api/movements\")) {\n        return await handleMovements(request, env, url);\n      }\n      if (pathname === \"/api/upload-image\") {\n        return await handleUploadImage(request, env, url);\n      }\n      if (pathname.startsWith(\"/api/images\")) {\n        return await handleImages(request, env, url);\n      }\n      if (pathname.startsWith(\"/uploads/\")) {\n        return await handleServeUpload(request, env, url);\n      }\n\n      return json({ error: \"Not found\" }, 404);\n    } catch (err) {\n      console.error(\"Worker error:\", err);\n      return json({ error: \"Internal server error\" }, 500);\n    }\n  },\n};\n\n// ===== Helpers chung =====\n\nfunction corsHeaders() {\n  return {\n    \"Access-Control-Allow-Origin\": \"*\", // khi xong c\u00F3 th\u1EC3 gi\u1EDBi h\u1EA1n theo domain c\u1EE7a b\u1EA1n\n    \"Access-Control-Allow-Methods\": \"GET,POST,PUT,DELETE,OPTIONS\",\n    \"Access-Control-Allow-Headers\": \"Content-Type\",\n  };\n}\n\nfunction json(data, status = 200) {\n  return new Response(JSON.stringify(data), {\n    status,\n    headers: {\n      \"Content-Type\": \"application/json; charset=utf-8\",\n      ...corsHeaders(),\n    },\n  });\n}\n\nasync function readJson(request) {\n  const text = await request.text();\n  if (!text) return {};\n  try {\n    return JSON.parse(text);\n  } catch {\n    return {};\n  }\n}\n\n// ======================================================\n//  /api/attributes  (M\u00E0u / Size / Danh m\u1EE5c + tr\u1EA1ng th\u00E1i)\n// ======================================================\nasync function handleAttributes(request, env, url) {\n  const db = env.DB;\n  const { pathname, searchParams } = url;\n  const parts = pathname.split(\"/\").filter(Boolean); // [\"api\",\"attributes\",\":id?\"]\n  const id = parts.length === 3 ? Number(parts[2]) : null;\n\n  // GET /api/attributes?type=color&onlyActive=1\n  if (request.method === \"GET\" && !id) {\n    const type = searchParams.get(\"type\");\n    const onlyActive = searchParams.get(\"onlyActive\");\n    let sql = \"SELECT id,type,name,color_code,status FROM attributes\";\n    const conds = [];\n    const binds = [];\n\n    if (type && [\"color\", \"size\", \"category\"].includes(type)) {\n      conds.push(\"type = ?\");\n      binds.push(type);\n    }\n    if (onlyActive === \"1\") {\n      conds.push(\"status = 1\");\n    }\n    if (conds.length) {\n      sql += \" WHERE \" + conds.join(\" AND \");\n    }\n    sql += \" ORDER BY type,name ASC\";\n\n    const res = await db.prepare(sql).bind(...binds).all();\n    return json(res.results || []);\n  }\n\n  // POST /api/attributes\n  if (request.method === \"POST\" && !id) {\n    const body = await readJson(request);\n    let { type, name, color_code, status } = body || {};\n\n    if (!type || ![\"color\", \"size\", \"category\"].includes(type)) {\n      return json({ error: \"Lo\u1EA1i ph\u00E2n lo\u1EA1i kh\u00F4ng h\u1EE3p l\u1EC7\" }, 400);\n    }\n    if (!name || !String(name).trim()) {\n      return json({ error: \"T\u00EAn ph\u00E2n lo\u1EA1i kh\u00F4ng \u0111\u01B0\u1EE3c \u0111\u1EC3 tr\u1ED1ng\" }, 400);\n    }\n\n    const cleanType = String(type).trim();\n    const cleanName = String(name).trim();\n    const cleanColor = color_code ? String(color_code).trim() : null;\n    const cleanStatus = status != null ? Number(status) : 1;\n\n    try {\n      const info = await db\n        .prepare(\n          \"INSERT INTO attributes (type,name,color_code,status) VALUES (?,?,?,?)\"\n        )\n        .bind(cleanType, cleanName, cleanColor, cleanStatus)\n        .run();\n\n      return json(\n        {\n          id: info.lastInsertRowId,\n          type: cleanType,\n          name: cleanName,\n          color_code: cleanColor,\n          status: cleanStatus,\n        },\n        201\n      );\n    } catch (err) {\n      const msg = String(err.message || \"\");\n      if (msg.includes(\"UNIQUE\")) {\n        return json({ error: \"Ph\u00E2n lo\u1EA1i n\u00E0y \u0111\u00E3 t\u1ED3n t\u1EA1i\" }, 409);\n      }\n      console.error(\"INSERT attributes error:\", err);\n      return json({ error: \"L\u1ED7i m\u00E1y ch\u1EE7 khi t\u1EA1o ph\u00E2n lo\u1EA1i\" }, 500);\n    }\n  }\n\n  // PUT /api/attributes/:id\n  if (request.method === \"PUT\" && id) {\n    const body = await readJson(request);\n    let { name, color_code, status } = body || {};\n\n    if (!name || !String(name).trim()) {\n      return json({ error: \"T\u00EAn ph\u00E2n lo\u1EA1i kh\u00F4ng \u0111\u01B0\u1EE3c \u0111\u1EC3 tr\u1ED1ng\" }, 400);\n    }\n\n    const cleanName = String(name).trim();\n    const cleanColor = color_code ? String(color_code).trim() : null;\n    const cleanStatus = status != null ? Number(status) : 1;\n\n    try {\n      const result = await db\n        .prepare(\n          \"UPDATE attributes SET name=?,color_code=?,status=? WHERE id=?\"\n        )\n        .bind(cleanName, cleanColor, cleanStatus, id)\n        .run();\n\n      if (result.rowsAffected === 0) {\n        return json({ error: \"Kh\u00F4ng t\u00ECm th\u1EA5y ph\u00E2n lo\u1EA1i\" }, 404);\n      }\n      return json({ ok: true });\n    } catch (err) {\n      console.error(\"UPDATE attributes error:\", err);\n      return json({ error: \"L\u1ED7i m\u00E1y ch\u1EE7 khi s\u1EEDa ph\u00E2n lo\u1EA1i\" }, 500);\n    }\n  }\n\n  // DELETE /api/attributes/:id\n  if (request.method === \"DELETE\" && id) {\n    try {\n      const result = await db\n        .prepare(\"DELETE FROM attributes WHERE id=?\")\n        .bind(id)\n        .run();\n\n      if (result.rowsAffected === 0) {\n        return json({ error: \"Kh\u00F4ng t\u00ECm th\u1EA5y ph\u00E2n lo\u1EA1i\" }, 404);\n      }\n      return json({ ok: true, deleted: result.rowsAffected });\n    } catch (err) {\n      console.error(\"DELETE attributes error:\", err);\n      return json({ error: \"L\u1ED7i m\u00E1y ch\u1EE7 khi xo\u00E1 ph\u00E2n lo\u1EA1i\" }, 500);\n    }\n  }\n\n  return json({ error: \"Method not allowed\" }, 405);\n}\n\n// =======================================\n//  /api/products  (S\u1EA3n ph\u1EA9m + bi\u1EBFn th\u1EC3)\n// =======================================\nasync function handleProducts(request, env, url) {\n  const db = env.DB;\n  const { pathname } = url;\n  const parts = pathname.split(\"/\").filter(Boolean); // [\"api\",\"products\",\":masp?\"]\n  const masp = parts.length === 3 ? decodeURIComponent(parts[2]) : null;\n\n  // GET /api/products\n  if (request.method === \"GET\" && !masp) {\n    const productsRes = await db\n      .prepare(\"SELECT * FROM products ORDER BY id DESC\")\n      .all();\n    const variantsRes = await db\n      .prepare(\"SELECT * FROM product_variants ORDER BY id ASC\")\n      .all();\n\n    const products = productsRes.results || [];\n    const variants = variantsRes.results || [];\n    const byProduct = {};\n\n    for (const v of variants) {\n      (byProduct[v.product_id] ||= []).push(v);\n    }\n\n    const result = products.map((p) => ({\n      ...p,\n      variants: byProduct[p.id] || [],\n    }));\n\n    return json(result);\n  }\n\n  // POST /api/products\n  if (request.method === \"POST\" && !masp) {\n    const body = await readJson(request);\n    const { name, cost, note, category, variants } = body || {};\n\n    if (!name || !String(name).trim()) {\n      return json({ error: \"T\u00EAn s\u1EA3n ph\u1EA9m kh\u00F4ng \u0111\u01B0\u1EE3c \u0111\u1EC3 tr\u1ED1ng\" }, 400);\n    }\n\n    const cleanName = String(name).trim();\n    const cleanNote =\n      note && String(note).trim() ? String(note).trim() : null;\n    const cleanCost =\n      cost != null && String(cost) !== \"\" ? Number(cost) : null;\n    const cleanCategory =\n      category && String(category).trim() ? String(category).trim() : null;\n    const variantList = Array.isArray(variants) ? variants : [];\n\n    const maSP = crypto.randomUUID();\n\n    const info = await db\n      .prepare(\n        \"INSERT INTO products (MaSP,name,cost,note,category) VALUES (?,?,?,?,?)\"\n      )\n      .bind(maSP, cleanName, cleanCost, cleanNote, cleanCategory)\n      .run();\n\n    const productId = info.lastInsertRowId;\n\n    const createdVariants = [];\n    for (const v of variantList) {\n      const color = v.color ? String(v.color).trim() : null;\n      const size = v.size ? String(v.size).trim() : null;\n      const qty = v.quantity != null ? Number(v.quantity) : 0;\n      const img = v.img ? String(v.img).trim() : null;\n\n      const r = await db\n        .prepare(\n          \"INSERT INTO product_variants (product_id,color,size,quantity,img) VALUES (?,?,?,?,?)\"\n        )\n        .bind(productId, color, size, qty, img)\n        .run();\n\n      createdVariants.push({\n        id: r.lastInsertRowId,\n        product_id: productId,\n        color,\n        size,\n        quantity: qty,\n        img,\n      });\n    }\n\n    return json(\n      {\n        id: productId,\n        MaSP: maSP,\n        name: cleanName,\n        cost: cleanCost,\n        note: cleanNote,\n        category: cleanCategory,\n        variants: createdVariants,\n      },\n      201\n    );\n  }\n\n  if (!masp) {\n    return json({ error: \"Thi\u1EBFu m\u00E3 s\u1EA3n ph\u1EA9m\" }, 400);\n  }\n\n  // PUT /api/products/:masp\n  if (request.method === \"PUT\") {\n    const body = await readJson(request);\n    const { name, cost, note, category, variants } = body || {};\n\n    if (!name || !String(name).trim()) {\n      return json({ error: \"T\u00EAn s\u1EA3n ph\u1EA9m kh\u00F4ng \u0111\u01B0\u1EE3c \u0111\u1EC3 tr\u1ED1ng\" }, 400);\n    }\n\n    const cleanName = String(name).trim();\n    const cleanNote =\n      note && String(note).trim() ? String(note).trim() : null;\n    const cleanCost =\n      cost != null && String(cost) !== \"\" ? Number(cost) : null;\n    const cleanCategory =\n      category && String(category).trim() ? String(category).trim() : null;\n    const variantList = Array.isArray(variants) ? variants : [];\n\n    const prod = await db\n      .prepare(\"SELECT id FROM products WHERE MaSP = ?\")\n      .bind(masp)\n      .get();\n\n    if (!prod) {\n      return json({ error: \"Kh\u00F4ng t\u00ECm th\u1EA5y s\u1EA3n ph\u1EA9m\" }, 404);\n    }\n\n    const productId = prod.id;\n\n    await db\n      .prepare(\n        \"UPDATE products SET name=?,cost=?,note=?,category=? WHERE id=?\"\n      )\n      .bind(cleanName, cleanCost, cleanNote, cleanCategory, productId)\n      .run();\n\n    // \u0110\u01A1n gi\u1EA3n: xo\u00E1 h\u1EBFt bi\u1EBFn th\u1EC3 c\u0169 r\u1ED3i th\u00EAm l\u1EA1i (n\u1EBFu b\u1EA1n mu\u1ED1n gi\u1EEF history variant id th\u00EC logic s\u1EBD ph\u1EE9c t\u1EA1p h\u01A1n)\n    await db\n      .prepare(\"DELETE FROM product_variants WHERE product_id = ?\")\n      .bind(productId)\n      .run();\n\n    const updatedVariants = [];\n    for (const v of variantList) {\n      const color = v.color ? String(v.color).trim() : null;\n      const size = v.size ? String(v.size).trim() : null;\n      const qty = v.quantity != null ? Number(v.quantity) : 0;\n      const img = v.img ? String(v.img).trim() : null;\n\n      const r = await db\n        .prepare(\n          \"INSERT INTO product_variants (product_id,color,size,quantity,img) VALUES (?,?,?,?,?)\"\n        )\n        .bind(productId, color, size, qty, img)\n        .run();\n\n      updatedVariants.push({\n        id: r.lastInsertRowId,\n        product_id: productId,\n        color,\n        size,\n        quantity: qty,\n        img,\n      });\n    }\n\n    return json({ ok: true });\n  }\n\n  // DELETE /api/products/:masp\n  if (request.method === \"DELETE\") {\n    const prod = await db\n      .prepare(\"SELECT id FROM products WHERE MaSP = ?\")\n      .bind(masp)\n      .get();\n\n    if (!prod) {\n      return json({ error: \"Kh\u00F4ng t\u00ECm th\u1EA5y s\u1EA3n ph\u1EA9m\" }, 404);\n    }\n\n    const productId = prod.id;\n    await db\n      .prepare(\"DELETE FROM product_variants WHERE product_id=?\")\n      .bind(productId)\n      .run();\n    await db.prepare(\"DELETE FROM products WHERE id=?\").bind(productId).run();\n\n    return json({ ok: true });\n  }\n\n  return json({ error: \"Method not allowed\" }, 405);\n}\n\n// =======================================\n//  /api/movements  (Nh\u1EADp / xu\u1EA5t kho)\n// =======================================\nasync function handleMovements(request, env, url) {\n  const db = env.DB;\n\n  // GET /api/movements\n  if (request.method === \"GET\") {\n    const sql = `\n      SELECT\n        m.*,\n        p.name AS productName,\n        TRIM(\n          COALESCE(v.color, '') ||\n          CASE WHEN v.color IS NOT NULL AND v.size IS NOT NULL THEN ' / ' ELSE '' END ||\n          COALESCE(v.size, '')\n        ) AS variant\n      FROM movements m\n      LEFT JOIN products p ON p.id = m.product_id\n      LEFT JOIN product_variants v ON v.id = m.variant_id\n      ORDER BY m.time DESC, m.id DESC\n    `;\n    const res = await db.prepare(sql).all();\n    return json(res.results || []);\n  }\n\n  // POST /api/movements\n  if (request.method === \"POST\") {\n    const body = await readJson(request);\n    let { variantId, type, quantity, user, note } = body || {};\n\n    const variant_id = Number(variantId);\n    const qty = Number(quantity || 0);\n    const cleanType =\n      String(type || \"\").toUpperCase() === \"OUT\" ? \"OUT\" : \"IN\";\n    const cleanUser =\n      user && String(user).trim() ? String(user).trim() : null;\n    const cleanNote =\n      note && String(note).trim() ? String(note).trim() : null;\n\n    if (!variant_id || !qty || qty <= 0) {\n      return json({ error: \"D\u1EEF li\u1EC7u kh\u00F4ng h\u1EE3p l\u1EC7\" }, 400);\n    }\n\n    const row = await db\n      .prepare(\n        `SELECT v.*, p.id AS productId\n         FROM product_variants v\n         JOIN products p ON p.id = v.product_id\n         WHERE v.id = ?`\n      )\n      .bind(variant_id)\n      .get();\n\n    if (!row) {\n      return json({ error: \"Kh\u00F4ng t\u00ECm th\u1EA5y bi\u1EBFn th\u1EC3\" }, 404);\n    }\n\n    let newQty = row.quantity || 0;\n    if (cleanType === \"IN\") {\n      newQty = newQty + qty;\n    } else {\n      if (qty > newQty) {\n        return json({ error: \"Xu\u1EA5t v\u01B0\u1EE3t qu\u00E1 t\u1ED3n hi\u1EC7n t\u1EA1i\" }, 400);\n      }\n      newQty = newQty - qty;\n    }\n\n    await db\n      .prepare(\"UPDATE product_variants SET quantity = ? WHERE id = ?\")\n      .bind(newQty, variant_id)\n      .run();\n\n    const time = new Date().toISOString();\n\n    await db\n      .prepare(\n        \"INSERT INTO movements (product_id,variant_id,type,quantity,user,time,note) VALUES (?,?,?,?,?,?,?)\"\n      )\n      .bind(row.productId, variant_id, cleanType, qty, cleanUser, time, cleanNote)\n      .run();\n\n    return json({ ok: true });\n  }\n\n  return json({ error: \"Method not allowed\" }, 405);\n}\n\n// =======================================\n//  Upload \u1EA3nh + danh s\u00E1ch \u1EA3nh (R2)\n// =======================================\nasync function handleUploadImage(request, env, url) {\n  if (request.method !== \"POST\") {\n    return json({ error: \"Method not allowed\" }, 405);\n  }\n  if (!env.BUCKET) {\n    return json({ error: \"Bucket ch\u01B0a \u0111\u01B0\u1EE3c c\u1EA5u h\u00ECnh\" }, 500);\n  }\n\n  const formData = await request.formData();\n  const files = formData.getAll(\"image\"); // input name=\"image\" multiple\n\n  if (!files || files.length === 0) {\n    return json({ error: \"Kh\u00F4ng c\u00F3 file n\u00E0o \u0111\u01B0\u1EE3c g\u1EEDi l\u00EAn\" }, 400);\n  }\n\n  const uploaded = [];\n\n  for (const file of files) {\n    if (typeof file === \"string\") continue;\n\n    const extMatch = /\\.[a-zA-Z0-9]+$/.exec(file.name || \"\");\n    const ext = extMatch ? extMatch[0] : \"\";\n    const key = `${Date.now()}-${Math.random()\n      .toString(36)\n      .slice(2)}${ext}`;\n\n    await env.BUCKET.put(key, file.stream());\n\n    uploaded.push({\n      key,\n      url: `/uploads/${encodeURIComponent(key)}`,\n      filename: file.name || key,\n    });\n  }\n\n  return json(\n    {\n      ok: true,\n      count: uploaded.length,\n      files: uploaded,\n    },\n    201\n  );\n}\n\nasync function handleImages(request, env, url) {\n  if (!env.BUCKET) {\n    return json({ error: \"Bucket ch\u01B0a \u0111\u01B0\u1EE3c c\u1EA5u h\u00ECnh\" }, 500);\n  }\n\n  // GET /api/images\n  if (request.method === \"GET\") {\n    const list = await env.BUCKET.list();\n    const images = (list.objects || []).map((obj) => ({\n      url: `/uploads/${encodeURIComponent(obj.key)}`,\n      filename: obj.key,\n    }));\n    return json(images);\n  }\n\n  // DELETE /api/images\n  if (request.method === \"DELETE\") {\n    const body = await readJson(request);\n    const { urls } = body || {};\n    const toDelete = Array.isArray(urls) ? urls : [];\n    const deleted = [];\n    const notFound = [];\n\n    for (const u of toDelete) {\n      try {\n        const uObj = new URL(u, \"http://dummy\");\n        const key = decodeURIComponent(\n          uObj.pathname.replace(/^\\/uploads\\//, \"\")\n        );\n        await env.BUCKET.delete(key);\n        deleted.push(u);\n      } catch (err) {\n        console.error(\"DELETE image error:\", err);\n        notFound.push(u);\n      }\n    }\n\n    return json({\n      ok: true,\n      deletedCount: deleted.length,\n      deleted,\n      notFound,\n    });\n  }\n\n  return json({ error: \"Method not allowed\" }, 405);\n}\n\n// Serve \u1EA3nh t\u1EEB R2: GET /uploads/:key\nasync function handleServeUpload(request, env, url) {\n  if (!env.BUCKET) {\n    return new Response(\"Bucket not configured\", { status: 500 });\n  }\n\n  const key = decodeURIComponent(url.pathname.replace(/^\\/uploads\\//, \"\"));\n  const obj = await env.BUCKET.get(key);\n\n  if (!obj) {\n    return new Response(\"Not found\", { status: 404 });\n  }\n\n  const headers = new Headers();\n  headers.set(\n    \"Content-Type\",\n    (obj.httpMetadata && obj.httpMetadata.contentType) || \"image/jpeg\"\n  );\n  headers.set(\"Cache-Control\", \"public, max-age=31536000\");\n\n  return new Response(obj.body, { status: 200, headers });\n}\n", "import type { Middleware } from \"./common\";\n\nconst drainBody: Middleware = async (request, env, _ctx, middlewareCtx) => {\n\ttry {\n\t\treturn await middlewareCtx.next(request, env);\n\t} finally {\n\t\ttry {\n\t\t\tif (request.body !== null && !request.bodyUsed) {\n\t\t\t\tconst reader = request.body.getReader();\n\t\t\t\twhile (!(await reader.read()).done) {}\n\t\t\t}\n\t\t} catch (e) {\n\t\t\tconsole.error(\"Failed to drain the unused request body.\", e);\n\t\t}\n\t}\n};\n\nexport default drainBody;\n", "import type { Middleware } from \"./common\";\n\ninterface JsonError {\n\tmessage?: string;\n\tname?: string;\n\tstack?: string;\n\tcause?: JsonError;\n}\n\nfunction reduceError(e: any): JsonError {\n\treturn {\n\t\tname: e?.name,\n\t\tmessage: e?.message ?? String(e),\n\t\tstack: e?.stack,\n\t\tcause: e?.cause === undefined ? undefined : reduceError(e.cause),\n\t};\n}\n\n// See comment in `bundle.ts` for details on why this is needed\nconst jsonError: Middleware = async (request, env, _ctx, middlewareCtx) => {\n\ttry {\n\t\treturn await middlewareCtx.next(request, env);\n\t} catch (e: any) {\n\t\tconst error = reduceError(e);\n\t\treturn Response.json(error, {\n\t\t\tstatus: 500,\n\t\t\theaders: { \"MF-Experimental-Error-Stack\": \"true\" },\n\t\t});\n\t}\n};\n\nexport default jsonError;\n", "\t\t\t\timport worker, * as OTHER_EXPORTS from \"/Users/tuanhung/Desktop/project/src/worker.js\";\n\t\t\t\timport * as __MIDDLEWARE_0__ from \"/Users/tuanhung/Desktop/project/node_modules/wrangler/templates/middleware/middleware-ensure-req-body-drained.ts\";\nimport * as __MIDDLEWARE_1__ from \"/Users/tuanhung/Desktop/project/node_modules/wrangler/templates/middleware/middleware-miniflare3-json-error.ts\";\n\n\t\t\t\texport * from \"/Users/tuanhung/Desktop/project/src/worker.js\";\n\n\t\t\t\texport const __INTERNAL_WRANGLER_MIDDLEWARE__ = [\n\t\t\t\t\t\n\t\t\t\t\t__MIDDLEWARE_0__.default,__MIDDLEWARE_1__.default\n\t\t\t\t]\n\t\t\t\texport default worker;", "export type Awaitable<T> = T | Promise<T>;\n// TODO: allow dispatching more events?\nexport type Dispatcher = (\n\ttype: \"scheduled\",\n\tinit: { cron?: string }\n) => Awaitable<void>;\n\nexport type IncomingRequest = Request<\n\tunknown,\n\tIncomingRequestCfProperties<unknown>\n>;\n\nexport interface MiddlewareContext {\n\tdispatch: Dispatcher;\n\tnext(request: IncomingRequest, env: any): Awaitable<Response>;\n}\n\nexport type Middleware = (\n\trequest: IncomingRequest,\n\tenv: any,\n\tctx: ExecutionContext,\n\tmiddlewareCtx: MiddlewareContext\n) => Awaitable<Response>;\n\nconst __facade_middleware__: Middleware[] = [];\n\n// The register functions allow for the insertion of one or many middleware,\n// We register internal middleware first in the stack, but have no way of controlling\n// the order that addMiddleware is run in service workers so need an internal function.\nexport function __facade_register__(...args: (Middleware | Middleware[])[]) {\n\t__facade_middleware__.push(...args.flat());\n}\nexport function __facade_registerInternal__(\n\t...args: (Middleware | Middleware[])[]\n) {\n\t__facade_middleware__.unshift(...args.flat());\n}\n\nfunction __facade_invokeChain__(\n\trequest: IncomingRequest,\n\tenv: any,\n\tctx: ExecutionContext,\n\tdispatch: Dispatcher,\n\tmiddlewareChain: Middleware[]\n): Awaitable<Response> {\n\tconst [head, ...tail] = middlewareChain;\n\tconst middlewareCtx: MiddlewareContext = {\n\t\tdispatch,\n\t\tnext(newRequest, newEnv) {\n\t\t\treturn __facade_invokeChain__(newRequest, newEnv, ctx, dispatch, tail);\n\t\t},\n\t};\n\treturn head(request, env, ctx, middlewareCtx);\n}\n\nexport function __facade_invoke__(\n\trequest: IncomingRequest,\n\tenv: any,\n\tctx: ExecutionContext,\n\tdispatch: Dispatcher,\n\tfinalMiddleware: Middleware\n): Awaitable<Response> {\n\treturn __facade_invokeChain__(request, env, ctx, dispatch, [\n\t\t...__facade_middleware__,\n\t\tfinalMiddleware,\n\t]);\n}\n", "// This loads all middlewares exposed on the middleware object and then starts\n// the invocation chain. The big idea is that we can add these to the middleware\n// export dynamically through wrangler, or we can potentially let users directly\n// add them as a sort of \"plugin\" system.\n\nimport ENTRY, { __INTERNAL_WRANGLER_MIDDLEWARE__ } from \"/Users/tuanhung/Desktop/project/.wrangler/tmp/bundle-8HlAwq/middleware-insertion-facade.js\";\nimport { __facade_invoke__, __facade_register__, Dispatcher } from \"/Users/tuanhung/Desktop/project/node_modules/wrangler/templates/middleware/common.ts\";\nimport type { WorkerEntrypointConstructor } from \"/Users/tuanhung/Desktop/project/.wrangler/tmp/bundle-8HlAwq/middleware-insertion-facade.js\";\n\n// Preserve all the exports from the worker\nexport * from \"/Users/tuanhung/Desktop/project/.wrangler/tmp/bundle-8HlAwq/middleware-insertion-facade.js\";\n\nclass __Facade_ScheduledController__ implements ScheduledController {\n\treadonly #noRetry: ScheduledController[\"noRetry\"];\n\n\tconstructor(\n\t\treadonly scheduledTime: number,\n\t\treadonly cron: string,\n\t\tnoRetry: ScheduledController[\"noRetry\"]\n\t) {\n\t\tthis.#noRetry = noRetry;\n\t}\n\n\tnoRetry() {\n\t\tif (!(this instanceof __Facade_ScheduledController__)) {\n\t\t\tthrow new TypeError(\"Illegal invocation\");\n\t\t}\n\t\t// Need to call native method immediately in case uncaught error thrown\n\t\tthis.#noRetry();\n\t}\n}\n\nfunction wrapExportedHandler(worker: ExportedHandler): ExportedHandler {\n\t// If we don't have any middleware defined, just return the handler as is\n\tif (\n\t\t__INTERNAL_WRANGLER_MIDDLEWARE__ === undefined ||\n\t\t__INTERNAL_WRANGLER_MIDDLEWARE__.length === 0\n\t) {\n\t\treturn worker;\n\t}\n\t// Otherwise, register all middleware once\n\tfor (const middleware of __INTERNAL_WRANGLER_MIDDLEWARE__) {\n\t\t__facade_register__(middleware);\n\t}\n\n\tconst fetchDispatcher: ExportedHandlerFetchHandler = function (\n\t\trequest,\n\t\tenv,\n\t\tctx\n\t) {\n\t\tif (worker.fetch === undefined) {\n\t\t\tthrow new Error(\"Handler does not export a fetch() function.\");\n\t\t}\n\t\treturn worker.fetch(request, env, ctx);\n\t};\n\n\treturn {\n\t\t...worker,\n\t\tfetch(request, env, ctx) {\n\t\t\tconst dispatcher: Dispatcher = function (type, init) {\n\t\t\t\tif (type === \"scheduled\" && worker.scheduled !== undefined) {\n\t\t\t\t\tconst controller = new __Facade_ScheduledController__(\n\t\t\t\t\t\tDate.now(),\n\t\t\t\t\t\tinit.cron ?? \"\",\n\t\t\t\t\t\t() => {}\n\t\t\t\t\t);\n\t\t\t\t\treturn worker.scheduled(controller, env, ctx);\n\t\t\t\t}\n\t\t\t};\n\t\t\treturn __facade_invoke__(request, env, ctx, dispatcher, fetchDispatcher);\n\t\t},\n\t};\n}\n\nfunction wrapWorkerEntrypoint(\n\tklass: WorkerEntrypointConstructor\n): WorkerEntrypointConstructor {\n\t// If we don't have any middleware defined, just return the handler as is\n\tif (\n\t\t__INTERNAL_WRANGLER_MIDDLEWARE__ === undefined ||\n\t\t__INTERNAL_WRANGLER_MIDDLEWARE__.length === 0\n\t) {\n\t\treturn klass;\n\t}\n\t// Otherwise, register all middleware once\n\tfor (const middleware of __INTERNAL_WRANGLER_MIDDLEWARE__) {\n\t\t__facade_register__(middleware);\n\t}\n\n\t// `extend`ing `klass` here so other RPC methods remain callable\n\treturn class extends klass {\n\t\t#fetchDispatcher: ExportedHandlerFetchHandler<Record<string, unknown>> = (\n\t\t\trequest,\n\t\t\tenv,\n\t\t\tctx\n\t\t) => {\n\t\t\tthis.env = env;\n\t\t\tthis.ctx = ctx;\n\t\t\tif (super.fetch === undefined) {\n\t\t\t\tthrow new Error(\"Entrypoint class does not define a fetch() function.\");\n\t\t\t}\n\t\t\treturn super.fetch(request);\n\t\t};\n\n\t\t#dispatcher: Dispatcher = (type, init) => {\n\t\t\tif (type === \"scheduled\" && super.scheduled !== undefined) {\n\t\t\t\tconst controller = new __Facade_ScheduledController__(\n\t\t\t\t\tDate.now(),\n\t\t\t\t\tinit.cron ?? \"\",\n\t\t\t\t\t() => {}\n\t\t\t\t);\n\t\t\t\treturn super.scheduled(controller);\n\t\t\t}\n\t\t};\n\n\t\tfetch(request: Request<unknown, IncomingRequestCfProperties>) {\n\t\t\treturn __facade_invoke__(\n\t\t\t\trequest,\n\t\t\t\tthis.env,\n\t\t\t\tthis.ctx,\n\t\t\t\tthis.#dispatcher,\n\t\t\t\tthis.#fetchDispatcher\n\t\t\t);\n\t\t}\n\t};\n}\n\nlet WRAPPED_ENTRY: ExportedHandler | WorkerEntrypointConstructor | undefined;\nif (typeof ENTRY === \"object\") {\n\tWRAPPED_ENTRY = wrapExportedHandler(ENTRY);\n} else if (typeof ENTRY === \"function\") {\n\tWRAPPED_ENTRY = wrapWorkerEntrypoint(ENTRY);\n}\nexport default WRAPPED_ENTRY;\n"],
  "mappings": "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",
  "names": []
}
